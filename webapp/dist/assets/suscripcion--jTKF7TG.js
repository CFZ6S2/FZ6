import{a as s,d as c}from"./firebase-config-env-BtJ4KElt.js";/* empty css               */import"./error-fixes-B-QQl9aC.js";import"./firebase-appcheck-B5Dlx5A0.js";import{onAuthStateChanged as d}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";import{doc as l,updateDoc as u,serverTimestamp as i}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";import"./theme-BOByySXs.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-functions.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-app-check.js";import"./logger-CnI7WBtq.js";let r=null;d(s,e=>{e?(r=e,document.getElementById("loadingOverlay").classList.add("hidden"),p()):window.location.href="/login.html"});function p(){paypal.Buttons({style:{shape:"rect",color:"gold",layout:"vertical",label:"subscribe",height:50},createSubscription:function(e,a){return a.subscription.create({plan_id:"P-43X73253LN792734JNEMEYLA",custom_id:r.uid})},onApprove:async function(e,a){console.log("Subscription approved:",e),document.getElementById("loadingOverlay").classList.remove("hidden");try{const t=l(c,"users",r.uid),o=new Date;o.setMonth(o.getMonth()+1),await u(t,{hasActiveSubscription:!0,subscriptionId:e.subscriptionID,subscriptionStartDate:i(),subscriptionEndDate:o,subscriptionStatus:"active",updatedAt:i()}),console.log("Firestore updated successfully"),document.getElementById("loadingOverlay").classList.add("hidden"),document.getElementById("successModal").classList.remove("opacity-0","pointer-events-none")}catch(t){console.error("Error updating Firestore:",t),document.getElementById("loadingOverlay").classList.add("hidden"),n("Error al activar tu membresía. Por favor contacta soporte.")}},onError:function(e){console.error("PayPal error:",e),document.getElementById("loadingOverlay").classList.add("hidden"),n("Hubo un error al procesar el pago. Por favor intenta nuevamente.")},onCancel:function(e){console.log("Subscription cancelled:",e),document.getElementById("loadingOverlay").classList.add("hidden"),n("Cancelaste el proceso de pago. Tu membresía no fue activada.")}}).render("#paypal-button-container")}function n(e){document.getElementById("errorMessage").textContent=e,document.getElementById("errorModal").classList.remove("opacity-0","pointer-events-none")}window.closeErrorModal=function(){document.getElementById("errorModal").classList.add("opacity-0","pointer-events-none")};window.redirectToSearch=function(){window.location.href="/buscar-usuarios.html"};
