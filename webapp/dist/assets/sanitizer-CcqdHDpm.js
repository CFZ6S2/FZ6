import{l as e}from"./logger-CnI7WBtq.js";function o(){return typeof window.DOMPurify<"u"}const s={html(t,n={}){if(!t)return"";if(o())try{const r={ALLOWED_TAGS:["b","i","em","strong","a","p","br","ul","ol","li","span"],ALLOWED_ATTR:["href","title","class"],ALLOW_DATA_ATTR:!1,SAFE_FOR_TEMPLATES:!0,...n},i=window.DOMPurify.sanitize(t,r);return e.debug("[Sanitizer] HTML sanitizado:",t.length,"chars"),i}catch(r){return e.error("[Sanitizer] Error sanitizando HTML:",r),this.text(t)}else return e.warn("[Sanitizer] DOMPurify no estÃ¡ cargado, usando textContent como fallback"),this.text(t)},text(t){if(!t)return"";const n=document.createElement("div");n.textContent=t;const r=n.textContent||n.innerText||"";return e.debug("[Sanitizer] Texto sanitizado (sin HTML):",t.length,"chars"),r},url(t){if(!t)return null;try{const n=new URL(t,window.location.origin);return["http:","https:","mailto:"].includes(n.protocol)?(e.debug("[Sanitizer] URL sanitizada:",t),n.href):(e.warn("[Sanitizer] Protocolo no permitido:",n.protocol),null)}catch(n){return e.warn("[Sanitizer] URL invÃ¡lida:",t,n),null}},attribute(t){if(!t)return"";const n=String(t).replace(/[<>"'`]/g,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"");return e.debug("[Sanitizer] Atributo sanitizado:",t.length,"chars"),n},javascript(t){if(!t)return"";const n=String(t).replace(/[^\w\s\-.,!?]/g,"").substring(0,1e3);return e.debug("[Sanitizer] String sanitizado para JS:",t.length,"chars"),n},isPotentiallyMalicious(t){if(!t)return!1;const n=[/<script[^>]*>.*?<\/script>/gi,/javascript:/gi,/on\w+\s*=/gi,/<iframe/gi,/eval\(/gi,/expression\(/gi,/<embed/gi,/<object/gi];for(const r of n)if(r.test(t))return e.warn("[Sanitizer] PatrÃ³n peligroso detectado:",r),!0;return!1},setHTML(t,n,r={}){if(!t){e.error("[Sanitizer] Element es null");return}const i=this.html(n,r);t.innerHTML=i,e.debug("[Sanitizer] HTML establecido en",t.tagName)},setText(t,n){if(!t){e.error("[Sanitizer] Element es null");return}t.textContent=this.text(n),e.debug("[Sanitizer] Texto establecido en",t.tagName)}};function a(){o()?(e.success("âœ… Sanitizador inicializado con DOMPurify"),e.info(`ğŸ“¦ DOMPurify version: ${window.DOMPurify.version||"unknown"}`)):(e.warn("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),e.warn("âš ï¸  DOMPurify no estÃ¡ cargado"),e.warn("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),e.warn(""),e.warn("El sanitizador usarÃ¡ textContent como fallback."),e.warn("Para mÃ¡xima protecciÃ³n, carga DOMPurify:"),e.warn(""),e.warn('<script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.8/dist/purify.min.js"><\/script>'),e.warn(""),e.warn("Agrega esto antes de tus scripts en el HTML."),e.warn("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a();typeof window<"u"&&(window.sanitizer=s);export{s};
