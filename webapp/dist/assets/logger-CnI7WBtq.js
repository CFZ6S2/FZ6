function i(){const e=window.location.hostname;return e==="localhost"||e==="127.0.0.1"||e.endsWith(".local")||new URLSearchParams(window.location.search).get("debug")==="true"}const r=new Set(["password","passwd","pwd","secret","apiKey","api_key","accessToken","access_token","refreshToken","refresh_token","privateKey","private_key","cvv","cvc","cardNumber","card_number","ssn","authorization","cookie","sessionId","session_id"]),f=new Set(["email","phone","telefono","mobile","dni","nif"]);function a(e,t){if(t==null)return t;const n=e.toLowerCase();if(r.has(e)||r.has(n))return"[REDACTED]";if(f.has(e)||f.has(n)){const o=String(t);return o.length<=4?"****":"****"+o.slice(-4)}if(typeof t=="string"&&t.includes("@")&&t.includes(".")){const o=t.split("@");if(o.length===2&&o[0].length>2)return o[0].substring(0,2)+"****@"+o[1]}return t}function s(e,t=0){if(t>10)return"[MAX_DEPTH]";if(e==null||typeof e!="object")return e;if(Array.isArray(e))return e.map(o=>s(o,t+1));const n={};for(const[o,c]of Object.entries(e))typeof c=="object"&&c!==null?n[o]=s(c,t+1):n[o]=a(o,c);return n}const l={debug(...e){if(i()){const t=e.map(n=>typeof n=="object"?s(n):n);console.log("[DEBUG]",...t)}},info(...e){if(i()){const t=e.map(n=>typeof n=="object"?s(n):n);console.info("[INFO]",...t)}},warn(...e){const t=e.map(n=>typeof n=="object"?s(n):n);console.warn("[WARN]",...t)},error(...e){const t=e.map(n=>n instanceof Error?{message:n.message,name:n.name,code:n.code,stack:i()?n.stack:void 0}:typeof n=="object"?s(n):n);console.error("[ERROR]",...t)},success(...e){if(i()){const t=e.map(n=>typeof n=="object"?s(n):n);console.log("%c[SUCCESS]","color: green; font-weight: bold",...t)}},security(e,t={}){const n=s(t);console.warn("[SECURITY]",e,n)},table(e){i()&&console.table(s(e))},time(e){i()&&console.time(e)},timeEnd(e){i()&&console.timeEnd(e)}};export{l};
