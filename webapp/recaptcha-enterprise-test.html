<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test reCAPTCHA Enterprise</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; }
    pre { background: #111; color: #ddd; padding: 12px; border-radius: 6px; overflow-x: auto; }
    button { padding: 10px 16px; border: none; background: #007bff; color: #fff; border-radius: 4px; cursor: pointer; }
    button:hover { background: #0056b3; }
  </style>
  <script>
    const SITE_KEY = '6LcIeB4sAAAAAIsW672Uvlem8ECauSVa2IwG1vfY';
    window.addEventListener('DOMContentLoaded', () => {
      const out = document.getElementById('out');
      function log(...args) {
        out.textContent += args.map(a => typeof a === 'object' ? JSON.stringify(a, null, 2) : String(a)).join(' ') + "\n";
      }
      const s = document.createElement('script');
      s.src = `https://www.google.com/recaptcha/enterprise.js?render=${SITE_KEY}`;
      s.async = true;
      s.onload = () => log('✅ enterprise.js cargado');
      s.onerror = () => log('❌ No se pudo cargar enterprise.js');
      document.head.appendChild(s);
      document.getElementById('run').addEventListener('click', () => {
        if (!window.grecaptcha || !window.grecaptcha.enterprise) {
          log('❌ grecaptcha.enterprise no disponible');
          return;
        }
        try {
          window.grecaptcha.enterprise.ready(async () => {
            try {
              const token = await window.grecaptcha.enterprise.execute(SITE_KEY, { action: 'appcheck' });
              log('✅ Token de reCAPTCHA Enterprise:', token.substring(0, 50) + '...');
            } catch (e) {
              log('❌ Error en execute:', e && e.message ? e.message : e);
            }
          });
        } catch (e) {
          log('❌ Error inicializando:', e && e.message ? e.message : e);
        }
      });
    });
  </script>
</head>
<body>
  <h1>Test reCAPTCHA Enterprise</h1>
  <p>Dominio: <strong id="host"></strong></p>
  <p>Site Key: <code>6LcIeB4sAAAAAIsW672Uvlem8ECauSVa2IwG1vfY</code></p>
  <button id="run">Ejecutar reCAPTCHA</button>
  <h2>Salida</h2>
  <pre id="out"></pre>
  <script>document.getElementById('host').textContent = location.hostname;</script>
</body>
</html>
